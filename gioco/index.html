<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="./css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Monoton" rel="stylesheet">
    <link rel="shortcut icon" type="image/x-icon" href="./assets/favicon.ico" />
    <title>Michael Jackson's Alive</title>
  </head>
  <body>
    <span id="modalOverlay">
      <div id="startGameModal" class="modalMessage">
        <h3>Michael Jackson's Alive</h3>
        <p>Usa i tasti direzionali per giocare. Usando i comandi in alto puoi anche mettere in pausa/riprendere e riavviare il gioco. Puoi anche regolare l'audio dei suoni.</p>
        <button id="redirectButton">Continua</button>
      </div>
      <div id="endGameModal" class="modalMessage">
        <h3 id = "risultato">Grazie per aver giocato</h3>
        <button id="playAgainButton">Gioca di nuovo</button>
      </div>
    </span>

    <aside class="sidebar">

      <div class="logo">
        <img src="../images/MJLogo.jpeg" alt="Logo" width="65" height="55">
    </div>

      <div class="user-info">
        <img src="./assets/user.png" alt="User" />
        <span id="username">Caricamento...</span>
      </div>
      <ul class="sidebar-links">
        <li>
          <a href="../homepage/homepage.html">
            <img src="./assets/home.png" alt="Home" />
            <span>HOME</span>
          </a>
        </li>
        <li>
          <a href="#">
            <img src="./assets/gioca.png" alt="Gioco" />
            <span>GIOCO</span>
          </a>
        </li>
        <li>
          <a href="#">
            <img src="./assets/shop.png" alt="Shop" />
            <span>SHOP</span>
          </a>
        </li>
        <li>
          <a href="#">
            <img src="./assets/classifica.png" alt="Classifica" />
            <span>CLASSIFICA</span>
          </a>
        </li>
      </ul>
    </aside>

    <script>
      document.addEventListener("DOMContentLoaded", async () => {
          try {
              const response = await fetch("./php/getUser.php"); // Percorso aggiornato
              const data = await response.json();
      
              const usernameSpan = document.getElementById("username");
      
              if (data.success) {
                  usernameSpan.textContent = data.username; // Mostra il nome utente
              } else {
                  usernameSpan.innerHTML = `<a href="../login-register/index.php">Non sei registrato. Registrati/Accedi</a>`;
              }
          } catch (error) {
              console.error("Errore nel recupero dell'utente:", error);
              document.getElementById("username").innerHTML = `<a href="../login-register/mj_login.html">Non sei registrato. Registrati/Accedi</a>`;
          }
      });
      </script>
      

    <div class="title">Michael Jackson's Alive</div>
    <section class="canvasArea">
      <div class="controls">
        <img id="pauseIcon" src="./assets/pause.png" title="Barra spaziatrice">
        <img id="restartIcon" src="./assets/restart.png">
        <img id="soundIcon" src="./assets/sound.png">
      </div>

      <label for="volume"></label>
      <input type="range" id="volume" min="0" max="1" step="0.01" value="0.5">

      <div id="score">Score: 0</div>
      <div class="combo">
        <p id="comboCount"></p>
        <span id="comboText">combo</span>
      </div>
      <canvas id="ttrCanvas" width="450" height="680"></canvas>
    </section>
    <div id="directions">
      <h4>Come giocare</h4>
      <ul>
        <li>Gioca usando le freccette direzionali</li>
        <li>Prova a far combaciare le frecce in movimento alle frecce statiche premendo le freccette direzionali nell'istante corretto.</li>
        <li>Un counter tiene conto dell'attuale combo/streak.</li>
        <li>Più alta è la combo, maggiori sono i punti che ricevi!</li>
        <li>Puoi mettere in pausa il gioco in qualsiasi momento premendo la barra spaziatrice o il tasto pausa in alto.</li>
      </ul>
      <button id="playButton1">Play Billie Jean</button>
      <button id="playButton2">Play Beat It</button>
      <button id="playButton3">Play Rock with You</button>
      <button id="playButton4">Play Smooth Criminal</button>
      <button id="playButton5">Play Thriller</button>

      <!--  ERANO DI TROPPO
      <button id="playButton6">Play Chicago</button>
      <button id="playButton7">Play P.Y.T. (Pretty Young Thing)</button>
      -->

    </div>

    <div class="countdown-container">
      <div class="number" id="countdown"></div>
    </div>
    
    <div class="arrowImages">
      <img id="left" src="./assets/staticLeft.png">
      <img id="down" src="./assets/staticDown.png">
      <img id="up" src="./assets/staticUp.png">
      <img id="right" src="./assets/staticRight.png">
    </div>
    <audio id="mainSong" src="./assets//Michael Jackson - Billie Jean (Official Video).mp3"></audio>
    <audio id="endApplause" src="./assets/applause.mp3"></audio>
  </body>
  <script defer src="./js/arrowSprites.js" type="text/javascript"></script>
  <script defer src="./js/script.js" type="text/javascript"></script>
</html>
